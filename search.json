---
layout: null
permalink: /search.json
---
[
{% assign searchable_items = site.posts | concat: site.logbook | sort: 'date' | reverse %}
{% assign empty_array = '' | split: '' %}
{% for item in searchable_items %}
  {% assign item_lang = item.lang | default: site.default_lang %}
  {% assign item_type = item.collection | default: 'posts' %}
  {% assign excerpt_text = item.excerpt | default: item.summary | default: item.content | strip_html | strip_newlines | truncate: 220 %}
  {% assign tags_array = item.tags %}
  {% if tags_array == nil or tags_array == empty %}
    {% assign tags_array = item.categories %}
  {% endif %}
  {% assign tags_json = empty_array %}
  {% if tags_array %}
    {% assign tags_json = tags_array | uniq %}
  {% endif %}
  {
    "title": {{ item.title | default: item.slug | jsonify }},
    "url": {{ item.url | relative_url | jsonify }},
    "type": {{ item_type | jsonify }},
    "lang": {{ item_lang | jsonify }},
    "date": {{ item.date | date: "%Y-%m-%d" | jsonify }},
    "excerpt": {{ excerpt_text | jsonify }},
    "tags": {{ tags_json | jsonify }},
    "hours_spent": {% if item_type == 'logbook' and item.hours_spent %}{{ item.hours_spent | plus: 0 | jsonify }}{% else %}null{% endif %},
    "focus_area": {% if item.focus_area %}{{ item.focus_area | jsonify }}{% else %}null{% endif %},
    "writing_hours": {% if item_type == 'posts' and item.writing_hours %}{{ item.writing_hours | plus: 0 | jsonify }}{% else %}null{% endif %}
  }{% unless forloop.last %},{% endunless %}
{% endfor %}
]
