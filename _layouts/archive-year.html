---
layout: page
---

{% assign current_lang = page.lang | default: site.default_lang | default: 'pl' %}
{% assign year_value = page.archive_year | default: page.year | append: '' %}
{% if current_lang == 'en' %}
  {% assign archive_base = '/en/archive/' %}
  {% assign back_label = 'Back to archive' %}
  {% assign year_label = 'Entries from' %}
{% else %}
  {% assign archive_base = '/archive/' %}
  {% assign back_label = 'Powrot do archiwum' %}
  {% assign year_label = 'Wpisy z roku' %}
{% endif %}

{% assign posts = '' | split: '' %}
{% for post in site.posts %}
  {% if post.lang == current_lang %}
    {% assign post_year = post.date | date: '%Y' %}
    {% if post_year == year_value %}
      {% assign posts = posts | push: post %}
    {% endif %}
  {% endif %}
{% endfor %}

{% assign logs = '' | split: '' %}
{% for entry in site.logbook %}
  {% if entry.lang == current_lang %}
    {% assign entry_year = entry.date | date: '%Y' %}
    {% if entry_year == year_value %}
      {% assign logs = logs | push: entry %}
    {% endif %}
  {% endif %}
{% endfor %}

<div class="d-flex flex-wrap align-items-center justify-content-between gap-2 mb-4">
  <a class="btn btn-outline-primary btn-sm" href="{{ archive_base | relative_url }}">{{ back_label }}</a>
  <span class="text-muted small">{{ year_label }} {{ year_value }}</span>
</div>

<div class="archive-page">
<section class="archive-sections">
  <div class="mb-5">
    <h2 id="posts" class="h3">{{ t.archive.sections.posts | default: 'All posts' }}</h2>
    <p class="text-muted">{{ t.archive.sections.posts_caption | default: 'Articles and write-ups documenting the journey.' }}</p>

    {% if posts.size > 0 %}
    <div class="row g-4">
      {% for post in posts %}
      {% assign summary = post.description | default: post.excerpt %}
      <div class="col-md-6 col-xl-4 d-flex">
        <article class="archive-card archive-card--post h-100">
          <div class="archive-card__badge">
            <span class="archive-card__icon">
              <i class="bi bi-journal-text" aria-hidden="true"></i>
            </span>
            <span>{{ t.archive.timeline.post_label | default: 'Post' }}</span>
          </div>

          <h3 class="archive-card__title">
            <a class="stretched-link text-decoration-none text-dark" href="{{ post.url | relative_url }}">
              {{ post.title }}
            </a>
          </h3>

          {% if summary %}
          <p class="archive-card__summary text-muted mb-3">
            {{ summary | strip_html | normalize_whitespace | truncate: 140 }}
          </p>
          {% endif %}

          {% if post.categories and post.categories.size > 0 %}
          <p class="archive-card__meta small text-muted mb-4">{{ post.categories | join: ', ' }}</p>
          {% endif %}

          <div class="archive-card__footer mt-auto d-flex align-items-center justify-content-between gap-3">
            <span class="archive-card__date small text-muted">
              <i class="bi bi-calendar3 me-1" aria-hidden="true"></i>{% include helpers/date-only.html value=post.date format=t.post.date_format %}
            </span>
            <a class="btn btn-outline-primary btn-sm px-3" href="{{ post.url | relative_url }}">
              {{ t.archive.card.open | default: 'Open entry' }} <i class="bi bi-arrow-up-right ms-1" aria-hidden="true"></i>
            </a>
          </div>
        </article>
      </div>
      {% endfor %}
    </div>
    {% else %}
    <p class="text-muted">{{ t.home.posts.empty | default: 'No posts published yet.' }}</p>
    {% endif %}
  </div>

  <div>
    <h2 id="logbook" class="h3">{{ t.archive.sections.logbook | default: 'Logbook sessions' }}</h2>
    <p class="text-muted">{{ t.archive.sections.logbook_caption | default: 'Time-on-task updates with hours, focus areas, and resources.' }}</p>

    {% if logs.size > 0 %}
    <div class="row g-4">
      {% for entry in logs %}
      {% assign summary = entry.description | default: entry.excerpt %}
      {% assign hours_template = t.archive.timeline.hours | default: '%{hours} h' %}
      {% assign hours_value = hours_template | replace: '%{hours}', entry.hours_spent | default: 0 %}
      <div class="col-md-6 col-xl-4 d-flex">
        <article class="archive-card archive-card--log h-100">
          <div class="archive-card__badge">
            <span class="archive-card__icon">
              <i class="bi bi-lightning-charge" aria-hidden="true"></i>
            </span>
            <span>{{ t.archive.timeline.log_label | default: 'Logbook' }}</span>
          </div>

          <h3 class="archive-card__title">
            <a class="stretched-link text-decoration-none text-dark" href="{{ entry.url | relative_url }}">
              {{ entry.title }}
            </a>
          </h3>

          {% if summary %}
          <p class="archive-card__summary text-muted mb-3">
            {{ summary | strip_html | normalize_whitespace | truncate: 160 }}
          </p>
          {% endif %}

          <p class="archive-card__meta small text-muted mb-4">
            {{ hours_value }}
            {% if entry.focus_area %}
            <span class="mx-1">&middot;</span>{{ entry.focus_area }}
            {% endif %}
          </p>

          <div class="archive-card__footer mt-auto d-flex align-items-center justify-content-between gap-3">
            <span class="archive-card__date small text-muted">
              <i class="bi bi-calendar3 me-1" aria-hidden="true"></i>{% include helpers/date-only.html value=entry.date format=t.post.date_format %}
            </span>
            <a class="btn btn-outline-primary btn-sm px-3" href="{{ entry.url | relative_url }}">
              {{ t.archive.card.open | default: 'Open entry' }} <i class="bi bi-arrow-up-right ms-1" aria-hidden="true"></i>
            </a>
          </div>
        </article>
      </div>
      {% endfor %}
    </div>
    {% else %}
    <p class="text-muted">{{ t.archive.sections.timeline_empty | default: 'Timeline will populate as posts and log entries are published.' }}</p>
    {% endif %}
  </div>
</section>
</div>
